<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Principal Component Analysis for outlier detection — pcadapt • pcadapt</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">pcadapt</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/pcadapt.html">Overview</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BioShock38/pcadapt">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Principal Component Analysis for outlier detection</h1>
    </div>

    
    <p><code>pcadapt</code> performs principal component analysis and computes p-values to test for outliers. The test for
outliers is based on the correlations between genetic variation and the first <code>K</code> principal components.
<code>pcadapt</code> also handles Pool-seq data for which the statistical analysis is
performed on the genetic markers frequencies. Returns an object of class <code>pcadapt</code>.</p>
    

    <pre><span class='fu'>pcadapt</span>(<span class='no'>input</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"mahalanobis"</span>, <span class='kw'>data.type</span> <span class='kw'>=</span> <span class='st'>"genotype"</span>,
  <span class='kw'>min.maf</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>ploidy</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>output.filename</span>, <span class='no'>clean.files</span>, <span class='no'>transpose</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>input</dt>
      <dd><p>a genotype matrix or a character string specifying the name of the file to be processed with <code>pcadapt</code>.</p></dd>
      <dt>K</dt>
      <dd><p>an integer specifying the number of principal components to retain.</p></dd>
      <dt>method</dt>
      <dd><p>a character string specifying the method to be used to compute
the p-values. Three statistics are currently available, <code>"mahalanobis"</code>,
<code>"communality"</code> and <code>"componentwise"</code>.</p></dd>
      <dt>data.type</dt>
      <dd><p>a character string specifying the type of data being read, either a <code>genotype</code> matrix (<code>data.type="genotype"</code>),
or a matrix of allele frequencies (<code>data.type="pool"</code>).</p></dd>
      <dt>min.maf</dt>
      <dd><p>a value between <code>0</code> and <code>0.45</code> specifying the threshold of minor allele frequencies above which p-values are computed.</p></dd>
      <dt>ploidy</dt>
      <dd><p>an integer specifying the ploidy of the individuals.</p></dd>
      <dt>output.filename</dt>
      <dd><p>deprecated argument.</p></dd>
      <dt>clean.files</dt>
      <dd><p>deprecated argument.</p></dd>
      <dt>transpose</dt>
      <dd><p>deprecated argument.</p></dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The returned value <code>x</code> is an object of class <code>pcadapt</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>First, a principal component analysis is performed on the scaled and centered genotype data. To account for missing
data, the correlation matrix between individuals is computed using only the markers available for each
pair of individuals. Depending on the specified <code>method</code>, different test statistics can be used.
    <code>mahalanobis</code> (default): the robust Mahalanobis distance is computed for each genetic marker using a robust
estimate of both mean and covariance matrix between the <code>K</code> vectors of z-scores.
    <code>communality</code>: the communality statistic measures the proportion of variance explained by the first <code>K</code> PCs.
    <code>componentwise</code>: returns a matrix of z-scores.</p>
<p>To compute p-values, test statistics (<code>stat</code>) are divided by a genomic inflation factor (<code>gif</code>) when <code>method="mahalanobis"</code>.
When <code>method="communality"</code>, the test statistic is first multiplied by <code>K</code> and divided by the percentage of variance explained by the first <code>K</code> PCs
before accounting for genomic inflation factor. When using <code>method="mahalanobis"</code> or <code>"communality"</code>, the scaled statistics (<code>chi2_stat</code>) should follow
a chi-squared distribution with <code>K</code> degrees of freedom. When using <code>method="componentwise"</code>, the z-scores should follow a chi-squared distribution with <code>1</code>
degree of freedom. For Pool-seq data, <code>pcadapt</code> provides p-values based on the Mahalanobis distance for each SNP.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Keurcien Luu, Michael Blum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
